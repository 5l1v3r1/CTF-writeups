First calaculate `left` using wiener rsa attack (d < n ^ (1/4))

```python
n = 338630205260455689413627911306068443537112802550361922213620660503310212139001530156458392949653034244789612680980241965923780722889133495349537107789761426092510299239678696031652780059016898519278860185536978111680123402473365833456785718098200501968322228116681190425490850863660038143310790555506293106653050174262471649179173093656763946257235681980586392230447218179278964626176124426615857733950102117938674282636936094069075258237416065546593509302494726576026227551920883962084579635168761189995794814926094510046419165007371450799003658587100556051088147493947712592469412133312536422828670173807709914587 # array[1]
e = 318540665379393469901456665807211509077755719995811520039095212139429238053864597311950397094944291616119321660193803737677538864969915331331528398734504661147661499115125056479426948683504604460936703005724827506058051215012025774714463561829608252938657297504427643593752676857551877096958959488289759878259498255905255543409142370769036479607835226542428818361327569095305960454592450213005148130508649794732855515489990191085723757628463901282599712670814223322126866814011761400443596552984309315434653984387419451894484613987942298157348306834118923950284809853541881602043240244910348705406353947587203832407 # array[0]
```
Use the script RSAwienerHacker.py

```python
from RSAwienerHacker import hack_RSA
```
get the private key

```python
d = hack_RSA(e,n)
```
Now we need to know the cipher to get the message (left)
The cipher is stored in a file with random 5-chars name 

![untitled](https://user-images.githubusercontent.com/46635361/51080501-8f5bf100-16e5-11e9-91fd-f2b532d2323a.png)

from temp.zip the cipher will be one of four

```python
c1 = 22904516087410958599400745295134407957538293849620479588699156943757304837190206382665810336482084781716773849605028263476508455731215761790645667054362539296225823398110243417691472133198440314276331355755866132461321596985526430056988927899479114899053294447700802697849092611264153732845034596143304147296894154594063406502535214999610175577413770003406849756759705571117279825037289641308088310214682418211107156983914990633688947345705294168540142293966230901741901843148151129118233782533371418208975094857361573218946344850619389994324095906207074062159093524286977819801023613457060607798022036303553020476
c2 = 254866065682021130439724704937184867571988898126920600312144202556337159335488307552034191341001334289495652540971128980722467151376324890145316009877658096246806325051196567044529609683599402485189329892395240384493083054505826600987614336430723213785881831176358478144388474300760084710212411934668239335533485693356382028168837946529365830131133223783968340244661008902365028927933626741730260578060987088277049516429347277957426341268861086257310107687596399904515666210206566515570142933731910160014673044494207393056295622419635061856638050287849658586267948950746076818312815168906437623990438374273215445550
c3 = 66986751702365023425546040811128085934255056222119634201596568962332666689417320304556447002675790986062966970352224594017211232884838178400589946497973469386294416000497968628420724798644253862335331326153504090767110404624684514870325486016592746662855557252592289165913143349801457748311698744736970450983876700104464797966354724061731369270046556016466415901905977429873127066683204343775880967437298869416520779738130821986475609249688136411106965188206590276353646797059304993638685907655812064741087007301962280880350682446416137921607796756476047717004303175907859332970054988289924695017467271667259367926
c4 = 59531950184882790356049596177169766243633485536127278113266454795985447480064539570462585630170415944367132840495806507836267093480678625545936817591854937033439937039828087075778881014953402678052943665968820811578551326692619551669234592698172896800413452669731627601552791837958452516251544653002721298308568913960606365275598616860812772279769873624613991630172996111045159009970449751316389066161574929704254356919957637115206987479209947250327261534001037332567509365955927492251220447277753564340324632065639087041582476532705138114620897878816737352411618205723180638342309329139458240894218141301303853211
```
so we calcualte the message for every one

```python
m1 = pow(c1,d,n)
m2 = pow(c2,d,n)
m3 = pow(c3,d,n)
m4 = pow(c4,d,n)
```

And because we want the plain text from it

```python
m1 = hex(m1).replace("0x",'').replace("L",'').decode('hex')
m2 = hex(m2).replace("0x",'').replace("L",'').decode('hex')
m3 = hex(m3).replace("0x",'').replace("L",'').decode('hex')
m4 = hex(m4).replace("0x",'').replace("L",'').decode('hex')

print("left = \"{}\" or \"{}\" or \"{}\" or \"{}\"".format(m1,m2,m3,m4))
# left = "3599427841201158309" or "2281123928613928259" or "1613383286900676679" or "2413992114436498344"
print("Now use them one by one on the ransomeware after patching it")
```

We patch the binary to decrypt the file
so the main method looks like this

```C#
private static void Main(string[] args)
		{
			string contents = cryptography.Aes(Convert.FromBase64String(File.ReadAllText(".\\dsafgasf.txt")), "<m1_then_m2_..>", "ABCDEFGHIJ12", false, true);
			File.WriteAllText(".\\sdagfsad.txt", contents);
			File.Delete(".\\dsafgasf.txt");
		}
```
